<!-- í¬ìŠ¤íŠ¸ ë‚´ ì–¸ì–´ ì „í™˜ ìŠ¤í¬ë¦½íŠ¸ - ë‹¨ìˆœí™”ëœ ë²„ì „ -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì–¸ì–´ ì „í™˜ ì´ˆê¸°í™”');

        // DOM ìš”ì†Œ êµì²´ ë°©ì‹ì˜ ì–¸ì–´ ì „í™˜ í•¨ìˆ˜
        function forceLanguageSwitch() {
            // í˜„ì¬ ì–¸ì–´ í™•ì¸ ë° ë¡œê¹…
            const lang = localStorage.getItem('lang') || 'ko';
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì–¸ì–´ ì „í™˜:', lang);

            try {
                // 1. ë³¸ë¬¸ ë‚´ìš© ì „í™˜ (DOM ìš”ì†Œ êµì²´ ë°©ì‹)
                const contentContainer = document.querySelector('.post-content');
                const koContent = document.querySelector('.post-content-ko');
                const enContent = document.querySelector('.post-content-en');

                if (contentContainer && koContent && enContent) {
                    // ë³µì œë³¸ ë§Œë“¤ê¸°
                    const koClone = koContent.cloneNode(true);
                    const enClone = enContent.cloneNode(true);

                    // ê°•ë ¥í•˜ê²Œ ìŠ¤íƒ€ì¼ ì ìš©
                    koClone.style.cssText = "width: 100%; " + (lang === 'ko' ? "display: block !important;" : "display: none !important;");
                    enClone.style.cssText = "width: 100%; " + (lang === 'ko' ? "display: none !important;" : "display: block !important;");

                    // ê¸°ì¡´ ìš”ì†Œ ì œê±°
                    while (contentContainer.firstChild) {
                        contentContainer.removeChild(contentContainer.firstChild);
                    }

                    // ìƒˆ ìš”ì†Œ ì¶”ê°€
                    contentContainer.appendChild(lang === 'ko' ? koClone : enClone);
                    contentContainer.appendChild(lang === 'ko' ? enClone : koClone);

                    console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ë³¸ë¬¸ ìš”ì†Œ êµì²´ ì™„ë£Œ');
                }

                // 2. ì¹´í…Œê³ ë¦¬/íƒœê·¸ ì—…ë°ì´íŠ¸ (ë°ì´í„° ì†ì„± ê¸°ë°˜)
                document.querySelectorAll('.post-categories .category-link span, .post-tags .tag-text').forEach(el => {
                    if (el.hasAttribute('data-ko') && el.hasAttribute('data-en')) {
                        el.textContent = lang === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                    }
                });

                // 3. ê¸°íƒ€ ë‹¤êµ­ì–´ ìš”ì†Œ
                document.querySelectorAll('[data-ko][data-en]').forEach(el => {
                    el.textContent = lang === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                });

                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ëª¨ë“  ìš”ì†Œ ì „í™˜ ì™„ë£Œ');
            } catch (err) {
                console.error('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì˜¤ë¥˜ ë°œìƒ:', err);
            }
        }

        // ì²« ì‹¤í–‰ì€ ì¦‰ì‹œ
        forceLanguageSwitch();

        // ì–¸ì–´ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ë³€ê²½ ê°ì§€)
        document.addEventListener('languageChanged', function () {
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì´ë²¤íŠ¸ ê°ì§€');
            forceLanguageSwitch();
        });

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì§ì ‘ ê°ì‹œ
        window.addEventListener('storage', function (e) {
            if (e.key === 'lang') {
                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ìŠ¤í† ë¦¬ì§€ ë³€ê²½ ê°ì§€:', e.newValue);
                forceLanguageSwitch();
            }
        });

        // í† ê¸€ ë²„íŠ¼ ì§ì ‘ ê°ì‹œ
        document.getElementById('language-toggle')?.addEventListener('click', function () {
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ë²„íŠ¼ í´ë¦­ ê°ì§€');
            setTimeout(forceLanguageSwitch, 100);
        });

        // ì•ˆì „ ì¥ì¹˜: ì§€ì—° ì‹¤í–‰ìœ¼ë¡œ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ ê°„ì„­ ë°©ì§€
        setTimeout(forceLanguageSwitch, 500);
        setTimeout(forceLanguageSwitch, 1000);
    });
</script>