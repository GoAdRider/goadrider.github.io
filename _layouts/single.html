<!-- í¬ìŠ¤íŠ¸ ë‚´ ì–¸ì–´ ì „í™˜ ìŠ¤í¬ë¦½íŠ¸ - ë‹¨ìˆœí™”ëœ ë²„ì „ -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì–¸ì–´ ì „í™˜ ì´ˆê¸°í™”');

        // DOM ìš”ì†Œ êµì²´ ë°©ì‹ì˜ ì–¸ì–´ ì „í™˜ í•¨ìˆ˜
        function forceLanguageSwitch() {
            // í˜„ì¬ ì–¸ì–´ í™•ì¸ ë° ë¡œê¹…
            const lang = localStorage.getItem('lang') || 'ko';
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì–¸ì–´ ì „í™˜:', lang);

            try {
                // 1. ë³¸ë¬¸ ë‚´ìš© ì „í™˜ (ê°•ë ¥í•œ ì§ì ‘ í‘œì‹œ/ìˆ¨ê¹€ ë°©ì‹)
                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ë³¸ë¬¸ ë‚´ìš© ì „í™˜ ì‹œì‘');

                // ì—¬ëŸ¬ ì„ íƒìë¥¼ ì‹œë„í•˜ì—¬ ëª¨ë“  ê°€ëŠ¥í•œ ë³¸ë¬¸ ìš”ì†Œ ì°¾ê¸°
                const koContents = document.querySelectorAll('.post-content-ko, [class*="post-content-ko"], [class^="post-content-ko"]');
                const enContents = document.querySelectorAll('.post-content-en, [class*="post-content-en"], [class^="post-content-en"]');

                console.log('[ï¿½ï¿½ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì½˜í…ì¸  ìš”ì†Œ ê°œìˆ˜:', {
                    'í•œêµ­ì–´ìš”ì†Œ': koContents.length,
                    'ì˜ì–´ìš”ì†Œ': enContents.length
                });

                // ê°•ë ¥í•œ ë°©ì‹ìœ¼ë¡œ í‘œì‹œ/ìˆ¨ê¹€ ì²˜ë¦¬
                if (koContents.length > 0 || enContents.length > 0) {
                    if (lang === 'ko') {
                        // í•œêµ­ì–´ í‘œì‹œ, ì˜ì–´ ìˆ¨ê¹€
                        koContents.forEach(el => {
                            el.style.cssText = "display: block !important; visibility: visible !important; opacity: 1 !important;";
                        });
                        enContents.forEach(el => {
                            el.style.cssText = "display: none !important; visibility: hidden !important; opacity: 0 !important;";
                        });
                    } else {
                        // ì˜ì–´ í‘œì‹œ, í•œêµ­ì–´ ìˆ¨ê¹€
                        koContents.forEach(el => {
                            el.style.cssText = "display: none !important; visibility: hidden !important; opacity: 0 !important;";
                        });
                        enContents.forEach(el => {
                            el.style.cssText = "display: block !important; visibility: visible !important; opacity: 1 !important;";
                        });
                    }

                    console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ë³¸ë¬¸ ë‚´ìš© ì „í™˜ ì™„ë£Œ:', lang === 'ko' ? 'í•œêµ­ì–´' : 'ì˜ì–´');

                    // ë³€ê²½ ì‚¬í•­ì´ DOMì— ë°˜ì˜ë˜ë„ë¡ ê°•ì œ ë¦¬í”Œë¡œìš°
                    document.body.offsetHeight;
                } else {
                    console.warn('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ë‹¤êµ­ì–´ ì½˜í…ì¸  ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                }

                // 2. ì¹´í…Œê³ ë¦¬/íƒœê·¸ ì—…ë°ì´íŠ¸ (ë°ì´í„° ì†ì„± ê¸°ë°˜)
                document.querySelectorAll('.post-categories .category-link span, .post-tags .tag-text').forEach(el => {
                    if (el.hasAttribute('data-ko') && el.hasAttribute('data-en')) {
                        el.textContent = lang === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                    }
                });

                // 3. ê¸°íƒ€ ë‹¤êµ­ì–´ ìš”ì†Œ
                document.querySelectorAll('[data-ko][data-en]').forEach(el => {
                    el.textContent = lang === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                });

                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ëª¨ë“  ìš”ì†Œ ì „í™˜ ì™„ë£Œ');
            } catch (err) {
                console.error('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì˜¤ë¥˜ ë°œìƒ:', err);
            }
        }

        // ì²« ì‹¤í–‰ì€ ì¦‰ì‹œ
        forceLanguageSwitch();

        // ì–¸ì–´ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ë³€ê²½ ê°ì§€)
        document.addEventListener('languageChanged', function () {
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì´ë²¤íŠ¸ ê°ì§€');
            forceLanguageSwitch();
        });

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì§ì ‘ ê°ì‹œ
        window.addEventListener('storage', function (e) {
            if (e.key === 'lang') {
                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ìŠ¤í† ë¦¬ì§€ ë³€ê²½ ê°ì§€:', e.newValue);
                forceLanguageSwitch();
            }
        });

        // í† ê¸€ ë²„íŠ¼ ì§ì ‘ ê°ì‹œ
        document.getElementById('language-toggle')?.addEventListener('click', function () {
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ë²„íŠ¼ í´ë¦­ ê°ì§€');
            setTimeout(forceLanguageSwitch, 100);
        });

        // ì•ˆì „ ì¥ì¹˜: ì§€ì—° ì‹¤í–‰ìœ¼ë¡œ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ ê°„ì„­ ë°©ì§€
        setTimeout(forceLanguageSwitch, 500);
        setTimeout(forceLanguageSwitch, 1000);
    });
</script>