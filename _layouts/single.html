<!-- í¬ìŠ¤íŠ¸ ë‚´ ì–¸ì–´ ì „í™˜ ìŠ¤í¬ë¦½íŠ¸ - ë‹¨ìˆœí™”ëœ ë²„ì „ -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì–¸ì–´ ì „í™˜ ì´ˆê¸°í™”');

        // DOM ìš”ì†Œ êµì²´ ë°©ì‹ì˜ ì–¸ì–´ ì „í™˜ í•¨ìˆ˜
        function forceLanguageSwitch() {
            // í˜„ì¬ ì–¸ì–´ í™•ì¸ ë° ë¡œê¹…
            const lang = localStorage.getItem('lang') || 'ko';
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì–¸ì–´ ì „í™˜:', lang);

            try {
                // 1. ê°€ì¥ ê°„ë‹¨í•œ ì ‘ê·¼ë²• - ì§ì ‘ ìŠ¤íƒ€ì¼ì‹œíŠ¸ ì‚½ì…
                const styleId = 'language-switch-styles';
                let styleEl = document.getElementById(styleId);

                if (!styleEl) {
                    styleEl = document.createElement('style');
                    styleEl.id = styleId;
                    document.head.appendChild(styleEl);
                }

                // ì•„ì£¼ ê°•ë ¥í•œ CSS ê·œì¹™ ì¶”ê°€ (ëª¨ë“  ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ì„ ë®ì–´ì”€)
                if (lang === 'ko') {
                    styleEl.innerHTML = `
                        .post-content-ko { display: block !important; visibility: visible !important; opacity: 1 !important; }
                        .post-content-en { display: none !important; visibility: hidden !important; opacity: 0 !important; }
                    `;
                    console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] í•œêµ­ì–´ ëª¨ë“œ ìŠ¤íƒ€ì¼ ì ìš©');
                } else {
                    styleEl.innerHTML = `
                        .post-content-ko { display: none !important; visibility: hidden !important; opacity: 0 !important; }
                        .post-content-en { display: block !important; visibility: visible !important; opacity: 1 !important; }
                    `;
                    console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì˜ì–´ ëª¨ë“œ ìŠ¤íƒ€ì¼ ì ìš©');
                }

                // 2. ì§ì ‘ DOM ìš”ì†Œ ìˆ˜ì • (ë°±ì—… ë©”ì»¤ë‹ˆì¦˜)
                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ë³¸ë¬¸ ìš”ì†Œ ì§ì ‘ ì¡°ì‘ ì‹œì‘');

                // ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ ìš”ì†Œ ì°¾ê¸° ì‹œë„
                const koContents = document.querySelectorAll('.post-content-ko');
                const enContents = document.querySelectorAll('.post-content-en');

                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì°¾ì€ ìš”ì†Œ:', {
                    'í•œêµ­ì–´': koContents.length,
                    'ì˜ì–´': enContents.length
                });

                // ì§ì ‘ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì ìš© (ê°€ì¥ ìš°ì„ ìˆœìœ„ ë†’ìŒ)
                if (lang === 'ko') {
                    koContents.forEach(el => {
                        console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] í•œêµ­ì–´ ìš”ì†Œ í‘œì‹œ:', el);
                        el.style.setProperty('display', 'block', 'important');
                        el.style.setProperty('visibility', 'visible', 'important');
                        el.style.setProperty('opacity', '1', 'important');
                    });

                    enContents.forEach(el => {
                        console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì˜ì–´ ìš”ì†Œ ìˆ¨ê¹€:', el);
                        el.style.setProperty('display', 'none', 'important');
                        el.style.setProperty('visibility', 'hidden', 'important');
                        el.style.setProperty('opacity', '0', 'important');
                    });
                } else {
                    koContents.forEach(el => {
                        console.log('[ï¿½ï¿½ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] í•œêµ­ì–´ ìš”ì†Œ ìˆ¨ê¹€:', el);
                        el.style.setProperty('display', 'none', 'important');
                        el.style.setProperty('visibility', 'hidden', 'important');
                        el.style.setProperty('opacity', '0', 'important');
                    });

                    enContents.forEach(el => {
                        console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì˜ì–´ ìš”ì†Œ í‘œì‹œ:', el);
                        el.style.setProperty('display', 'block', 'important');
                        el.style.setProperty('visibility', 'visible', 'important');
                        el.style.setProperty('opacity', '1', 'important');
                    });
                }

                // ì¶”ê°€ ë””ë²„ê¹… - ìš”ì†Œ ì†ì„± ì¶œë ¥
                if (koContents.length > 0) {
                    console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] í•œêµ­ì–´ ìš”ì†Œ í´ë˜ìŠ¤:', koContents[0].className);
                    console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] í•œêµ­ì–´ ìš”ì†Œ HTML:', koContents[0].outerHTML.substring(0, 100) + '...');
                }

                if (enContents.length > 0) {
                    console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì˜ì–´ ìš”ì†Œ í´ë˜ìŠ¤:', enContents[0].className);
                    console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì˜ì–´ ìš”ì†Œ HTML:', enContents[0].outerHTML.substring(0, 100) + '...');
                }

                // 3. ë‹¤ë¥¸ ì–¸ì–´ ìš”ì†Œë“¤ (ì¹´í…Œê³ ë¦¬, íƒœê·¸ ë“±) ì—…ë°ì´íŠ¸
                document.querySelectorAll('[data-ko][data-en]').forEach(el => {
                    el.textContent = lang === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                });

                // 4. ì¹´í…Œê³ ë¦¬/íƒœê·¸ íŠ¹ë³„ ì²˜ë¦¬
                document.querySelectorAll('.post-categories .category-link span, .post-tags .tag-text').forEach(el => {
                    if (el.hasAttribute('data-ko') && el.hasAttribute('data-en')) {
                        el.textContent = lang === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                    }
                });

                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ëª¨ë“  ìš”ì†Œ ì „í™˜ ì™„ë£Œ');

                // DOM ì—…ë°ì´íŠ¸ê°€ ë°˜ì˜ë˜ë„ë¡ ê°•ì œ
                document.body.offsetHeight;
            } catch (err) {
                console.error('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì˜¤ë¥˜ ë°œìƒ:', err);
            }
        }

        // ì²« ì‹¤í–‰ì€ ì¦‰ì‹œ
        forceLanguageSwitch();

        // ì–¸ì–´ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ë³€ê²½ ê°ì§€)
        document.addEventListener('languageChanged', function () {
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ì´ë²¤íŠ¸ ê°ì§€');
            forceLanguageSwitch();
        });

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì§ì ‘ ê°ì‹œ
        window.addEventListener('storage', function (e) {
            if (e.key === 'lang') {
                console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ìŠ¤í† ë¦¬ì§€ ë³€ê²½ ê°ì§€:', e.newValue);
                forceLanguageSwitch();
            }
        });

        // í† ê¸€ ë²„íŠ¼ ì§ì ‘ ê°ì‹œ
        document.getElementById('language-toggle')?.addEventListener('click', function () {
            console.log('[ğŸ’¡ í¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ] ë²„íŠ¼ í´ë¦­ ê°ì§€');
            setTimeout(forceLanguageSwitch, 100);
        });

        // ì•ˆì „ ì¥ì¹˜: ì§€ì—° ì‹¤í–‰ìœ¼ë¡œ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ ê°„ì„­ ë°©ì§€
        setTimeout(forceLanguageSwitch, 500);
        setTimeout(forceLanguageSwitch, 1000);
    });
</script>