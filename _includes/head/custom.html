<!-- start custom head snippets -->

<!-- Google Font 로드 - 비동기 로딩으로 변경 -->
{% if site.lang == "ko" or page.lang == "ko" %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet"
    media="print" onload="this.media='all'">
{% endif %}

<!-- Google Analytics - 비동기로 변경 -->
{% if jekyll.environment == 'production' and site.analytics.provider and page.analytics != false %}
{% include analytics.html %}
{% endif %}

<!-- Favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

<!-- end custom head snippets -->

<!-- 글로벌 스크립트 - 페이지 로드 전에 실행됨 (지연 로딩으로 변경) -->
<script src="{{ '/assets/js/global.js' | relative_url }}" defer></script>

<!-- 페이지 로딩 문제 자동 감지 및 복구 -->
<script>
    // 최소 기능 복구 시스템
    setTimeout(function () {
        if (document.readyState !== 'complete') {
            console.warn('[긴급모드] 페이지 로딩 지연 감지');

            // 로딩 완료 강제 트리거
            window.dispatchEvent(new Event('load'));
            document.dispatchEvent(new Event('DOMContentLoaded'));

            console.log('[긴급모드] 페이지 로딩 강제 완료');
        }
    }, 3000);
</script>